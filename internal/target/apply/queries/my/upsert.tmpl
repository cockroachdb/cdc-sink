{{- /*gotype: github.com/cockroachdb/cdc-sink/internal/target/apply.templates*/ -}}
{{- /*

INSERT INTO "schema"."table" 
  ("pk0","pk1","val0","val1","geom") 
  VALUES (cast (? as signed), cast( ? as char), cast(? as decimal), 
          cast(? as signed), st_geomfromgeojson(?))
  ON DUPLICATE KEY UPDATE val0=VALUES(val0),  val1=VALUES(val1),  geom=VALUES(geom);

*/ -}}

INSERT INTO {{ .TableName.Raw }} 
{{- if not .Data -}} IGNORE {{- end -}}
({{ template "names" .Columns }}) 
VALUES
{{ template "exprs" . }}
{{- if .Data }}
ON DUPLICATE KEY UPDATE 
{{ template "valuelist" .Data }}
{{- end -}}

{{- /* Trim whitespace */ -}}
